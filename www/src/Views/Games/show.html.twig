{% extends 'Layouts/main.html.twig' %}

{% block content %}
    <h1 class="text-neutral-300 text-2xl mb-2 ml-2"><strong>{{ game.name }}</strong></h1>
    <h2 class="text-neutral-300 text-lg mb-4 ml-2"><i class="fa-solid fa-tags"></i> Tags</h2>
    <form action="/tags/create.php" method="POST">
        <input type="hidden" name="game_id" value="{{ game.id }}">
        <div class="flex" id="app">
            <input type="text" name="name" placeholder="Name of the Tag" class="border-l border-y px-2 py-1 text-white text-center placeholder:text-neutral-200" :style="{ 'background-color': inputColor }">
            <input type="color" name="background_color" class="w-10 h-10 border" v-model="inputColor">
        </div>
        <button type="submit"><i class="fa-solid fa-paper-plane"></i> Tag erstellen</button>
        <div class="flex">
            {% for tag in tags %}
                <a  style="background-color: {{ tag.background_color }}"
                    href="/tagged_achievements/new.php?{{ { "tagid": tag.id }|url_encode }}"
                    class="text-sm py-1 px-2 text-white">
                    <i class="fa-solid fa-hashtag"></i> {{ tag.name }}
                </a>
            {% endfor %}
        </div>
    </form>
    <h2 class="text-neutral-300 text-lg mb-4 ml-2">Achievements</h2>
    <div class="grid gap-4 grid-cols-1 md:grid-cols-2 xl:grid-cols-3">
        {% for achievement in achievements %}
            <div class="flex flex-col justify-between w-full bg-neutral-800 p-1">
                <div class="flex">
                    <div style="background-image: url('{{ achievement.icon }}'); width: 50px; height: 50px"
                        class="bg-cover flex-none mr-2"></div>
                    <div class="w-full">
                        <p class="text-lg font-bold line-clamp-1 text-neutral-300" title="{{ achievement.display_name }}">{{ achievement.display_name }}</p>
                        <p>
                            {% for tagId in achievement.getTagIds %}
                                <span style="background-color: {{ tags[tagId].background_color }}" class="text-sm bg-neutral-500 p-1"><i class="fa-solid fa-hashtag"></i> {{ tags[tagId].name }}</span>
                            {% endfor %}
                        </p>
                        <p class="text-sm line-clamp-2 hover:line-clamp-none text-neutral-400">
                            {% if achievement.description is not null %}
                                {{ achievement.description }}
                            {% else %}
                                <a href="/games/edit.php?{{ { "achievementid": achievement.id }|url_encode }}" class="bg-yellow-900 text-neutral-200 px-1 py-0.5 inline-block">Add description</a>
                            {% endif %}
                        </p>
                    </div>
                </div>
                <div class="text-right text-sm text-neutral-100 mt-2">{{ achievement.percent }} %</div>
            </div>
        {% endfor %}
    </div>
    <script>
        const { createApp, ref, computed } = Vue
    
        createApp({
            setup() {
                const inputColor = ref('#000000')
    
                return { inputColor }
            }
        }).mount('#app')
    </script>
{% endblock %}
