{% extends 'Layouts/main.html.twig' %}

{% block head_content %}
    <title>Tracker | Games :: {{ game.name }}</title>
{% endblock %}

{% block content %}
    <header class="ml-4">
        <div class="text-neutral-300 text-2xl mb-2">{{ game.name }}</div>
        <form action="/tags/create.php" method="POST">
            <input type="hidden" name="game_id" value="{{ game.id }}">
            <label>Create Tag</label>
            <div class="flex mt-2" id="app">
                <div class="border-y border-l py-1 pl-2"><i class="fa-solid fa-hashtag"></i></div>
                <input type="text" name="name" placeholder="Name of the Tag" class="border-y border-r px-2 text-sm text-white placeholder:text-neutral-200" :style="{ 'background-color': inputColor }">
                <input type="color" name="background_color" class="w-8 h-8 border ml-2 mt-0.5" v-model="inputColor">
                <button type="submit" class="text-sm border py-1 px-2 ml-3 leading-3"><i class="fa-solid fa-paper-plane"></i> Create</button>
            </div>
        </form>
        <div class="text-neutral-300 text-lg mb-2 mt-4"><i class="fa-solid fa-tags"></i> Tags</div>
        <div class="flex">
            {% for tag in tags %}
                <a  style="background-color: {{ tag.background_color }}"
                    href="/tagged_achievements/new.php?{{ { "tagid": tag.id }|url_encode }}"
                    class="text-sm py-1 px-2 text-white">
                    <i class="fa-solid fa-hashtag"></i> {{ tag.name }}
                </a>
            {% endfor %}
        </div>
    </header>
    <div class="mt-4">
        <div class="text-neutral-300 text-lg mb-2 ml-2">Achievements</div>
        <div class="grid gap-1 grid-cols-1 md:grid-cols-2 xl:grid-cols-3">
            {% for achievement in achievements %}
                <div class="flex flex-col justify-between bg-neutral-800 w-full pb-2 pr-2">
                    <div>
                        <div class="flex mb-2 pl-2">
                            <div style="background-image: url('{{ achievement.icon }}')" class="w-8 h-8 hover:w-20 hover:h-20 bg-cover flex-none transition-all"></div>
                            <div class="text-md line-clamp-1 text-white px-2 pt-2" title="{{ achievement.display_name }}">{{ achievement.display_name }}</div>
                        </div>
                        <div class="text-sm line-clamp-2 hover:line-clamp-none text-neutral-400 px-2 pb-2">
                            {% if not achievement.hidden %}
                                {{ achievement.description }}
                            {% else %}
                                {{ achievement.description }}<br>
                                <a href="/games/edit.php?{{ { "achievementid": achievement.id }|url_encode }}" class="px-1 py-0.5 inline-block">
                                    <i class="fa-solid fa-pen-to-square"></i> {{ achievement.description is not null ? 'Edit' : 'Add' }} description
                                </a>
                            {% endif %}
                        </div>
                    </div>
                    <div class="flex justify-between">
                        <div>
                            {% for tagId in achievement.getTagIds %}
                                <span style="background-color: {{ tags[tagId].background_color }}" class="text-xs bg-white py-0.5 px-1">
                                    <i class="fa-solid fa-hashtag"></i> {{ tags[tagId].name }}
                                </span>
                            {% endfor %}
                        </div>
                        <div class="text-right text-xs text-neutral-500 mt-2">{{ achievement.percent }} %</div>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
    <script>
        const { createApp, ref, computed } = Vue
    
        createApp({
            setup() {
                const inputColor = ref('#000000')
    
                return { inputColor }
            }
        }).mount('#app')
    </script>
{% endblock %}
